---
import Layout from '@layouts/Layout.astro';
import Header from '@components/global/Header.astro';
import Footer from '@components/global/Footer.astro';
import Section from '@components/layout/Section.astro';
import Container from '@components/layout/Container.astro';
import InsightsHero from '@components/insights/InsightsHero.astro';
import FeaturedArticle from '@components/insights/FeaturedArticle.astro';
import InsightsFilter from '@components/insights/InsightsFilter';
import {
  getPublishedInsights,
  getPinnedInsight,
  getAllCategories,
  getAllTags,
  toMeta,
} from '@content/data/insights/index';

export const prerender = true;

const featured = getPinnedInsight();
const allPublished = getPublishedInsights();
const gridArticles = allPublished
  .filter((a) => featured ? a.slug !== featured.slug : true)
  .map(toMeta);
const categories = getAllCategories();
const tags = getAllTags();
---

<Layout
  title="Insights â€” Structured Perspectives on AI, Data & Architecture"
  description="Structured perspectives on AI readiness, architecture, governance and platform economics. Published weekly for enterprise leaders and technical decision-makers."
>
  <Header />
  <main id="main-content">
    <InsightsHero />

    {featured && <FeaturedArticle article={featured} />}

    <Section background="elevated" padding="default">
      <Container>
        <InsightsFilter
          client:load
          articles={gridArticles}
          categories={categories}
          tags={tags}
        />
      </Container>
    </Section>
  </main>
  <Footer />
</Layout>
